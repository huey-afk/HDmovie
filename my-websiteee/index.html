<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StreamFlix - A New Experience</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #000000;
        }
        #heroSection {
            transition: background-image 0.5s ease-in-out;
        }
        .hero-gradient {
            background-image: linear-gradient(to top, #000000, rgba(0, 0, 0, 0) 50%);
        }
        .main-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 1.5rem;
        }
        @media (min-width: 640px) {
            .main-grid {
                grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            }
        }
        @media (min-width: 768px) {
            .main-grid {
                grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            }
        }
        @media (min-width: 1024px) {
            .main-grid {
                grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            }
        }
        @media (min-width: 1280px) {
            .main-grid {
                grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            }
        }
        .poster-card {
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
            cursor: pointer;
            aspect-ratio: 2/3;
        }
        .poster-card img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        .poster-card:hover {
            transform: scale(1.05);
            box-shadow: 0 10px 25px rgba(0,0,0,0.5);
            z-index: 10;
        }
        .details-view {
            background-size: cover;
            background-position: center center;
            background-repeat: no-repeat;
        }
        .details-gradient {
            background: linear-gradient(to right, #000000 20%, rgba(0, 0, 0, 0.8) 50%, rgba(0, 0, 0, 0) 100%);
        }
        .server-list {
            scrollbar-width: thin;
            scrollbar-color: #4A5568 #2D3748;
        }
        .server-list::-webkit-scrollbar { width: 8px; }
        .server-list::-webkit-scrollbar-track { background: #2D3748; }
        .server-list::-webkit-scrollbar-thumb { background-color: #4A5568; border-radius: 4px; }
        .server-item.active { background-color: #e50914; border-left-color: #fff; }
        .movie-carousel {
            scrollbar-width: none;
            -ms-overflow-style: none;
        }
        .movie-carousel::-webkit-scrollbar { display: none; }
        .dropdown-content {
            display: none;
            grid-template-columns: repeat(2, 1fr);
        }
    </style>
</head>
<body class="text-gray-200">
    <!-- ... (rest of your HTML remains the same) ... -->
    <script>
        lucide.createIcons();

        const TMDB_API_KEY = 'a1e72fd93ed59f56e6332813b9f8dcae';  // Replace with your valid key
        const SERVERS = [ /* ... (unchanged) ... */ ];
        const TMDB_API_BASE = 'https://api.themoviedb.org/3';
        const TMDB_IMAGE_BASE_POSTER = 'https://image.tmdb.org/t/p/w500';
        const TMDB_IMAGE_BASE_BACKDROP = 'https://image.tmdb.org/t/p/original';

        const mainView = document.getElementById('mainView');
        // ... (rest of DOM elements)

        async function fetchAndDisplay(endpoint, title, mediaType) {
            try {
                let url = `${TMDB_API_BASE}/${endpoint}?api_key=${TMDB_API_KEY}&language=en-US&page=1`;
                const res = await fetch(url);
                if (!res.ok) throw new Error('API request failed');
                const data = await res.json();
                if (data.results && data.results.length > 0) {
                    const contentResults = data.results.map(item => ({...item, media_type: mediaType}));
                    createMovieRow(title, contentResults, endpoint, mediaType);
                    if (endpoint.includes('trending/movie')) {
                        const heroItem = contentResults[0];
                        if (heroItem && heroItem.backdrop_path) {
                            heroSection.style.backgroundImage = `url('${TMDB_IMAGE_BASE_BACKDROP}${heroItem.backdrop_path}')`;
                            heroTitle.textContent = heroItem.title || heroItem.name;
                            heroOverview.textContent = heroItem.overview;
                        }
                    }
                }
            } catch (error) {
                console.error(`Error fetching ${title}:`, error);
                // Display an error message in the hero section
                heroTitle.textContent = 'Error Loading Content';
                heroOverview.textContent = 'Failed to fetch data. Check your API key or network connection.';
            }
        }

        async function initializeApp() {
            if (!TMDB_API_KEY) {
                heroTitle.textContent = 'API Key Missing';
                heroOverview.textContent = 'Please set a valid TMDB API key.';
                return;
            }
            showMainView();
            setupDropdowns();
            buildGenreDropdown();
            movieRows.innerHTML = '';
            loadContinueWatching();
            await Promise.all([
                fetchAndDisplay('trending/movie/week', 'Trending Movies', 'movie'),
                fetchAndDisplay('trending/tv/week', 'Trending Series', 'tv'),
                // ... (rest of the array)
            ]).catch(error => {
                console.error('Initialization failed:', error);
                heroTitle.textContent = 'Error Initializing App';
                heroOverview.textContent = 'An error occurred. Check the console for details.';
            });
        }

        // ... (rest of the script remains the same)
    </script>
</body>
</html>
